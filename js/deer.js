const patchLivesCoinsDX = {
	o01: {dest: 0x291B, array: [0x3E, 0x0C, 0xEA, 0x00, 0x21, 0xCD, 0xE0,
                                0x7F, 0xFA, 0x4E, 0xA2, 0xEA, 0x00, 0x21, 0xC9]}
}

const patchLiveCoinsNotDX = {
	o01: {dest: 0x291B, array: [0x3E, 0x0C, 0xEA, 0x00, 0x21, 0xCD, 0xE0,
                                0x7F, 0x3E, 0x0C, 0xEA, 0x00, 0x21, 0xC9]}
}

const patchLivesCoins1_0 = {
	o01: {dest: 0x3023C, array: [0xCD, 0xE0, 0x7F, 0x18, 0x13]},
	o02: {dest: 0x33FE0, array: [0x3E, 0x00, 0x22, 0x3E, 0x00, 0x22, 0xAF, 0x22, 0x3E, 0x00, 0x22, 0xAF, 0x22, 0x3E, 0x02, 0x22, 0x3E, 0x12, 0x22, 0x3E, 0x34, 0x22, 0x3E, 0x56, 0x22, 0x3E, 0x78, 0x22, 0xC9]}
}

const patchLivesCoins1_2 = {
	o01: {dest: 0x291E, array: [0x3E, 0x0C, 0xEA, 0x00, 0x21, 0xCD, 0xE0, 0x7F, 0x3E, 0x0C, 0xEA, 0x00, 0x21, 0xC9]},
	o02: {dest: 0x3023C, array: [0xCD, 0xE0, 0x7F, 0x18, 0x13]},
	o03: {dest: 0x33FE0, array: [0x3E, 0x00, 0x22, 0x3E, 0x00, 0x22, 0xAF, 0x22, 0x3E, 0x00, 0x22, 0xAF, 0x22, 0x3E, 0x02, 0x22, 0x3E, 0x12, 0x22, 0x3E, 0x34, 0x22, 0x3E, 0x56, 0x22, 0x3E, 0x78, 0x22, 0xC9]}
}

function deer(rom) {
    let version1_2 = rom[0x14C] == 0x02;
    if (version1_2) {
        patch(patchLivesCoins1_2, rom);
    } else if (rom[0x148] == 0x05) {
        patch(patchLivesCoinsDX, rom);
        patch(patchLivesCoins1_0, rom);
    } else {
        patch(patchLiveCoinsNotDX, rom);
        patch(patchLivesCoins1_0, rom);
    }
    let livesOffset = version1_2 ? 0x27F5 : 0x27F2;
    //set lives to 0 after game over
    rom[livesOffset] = 0x00;
    //disable soft reset
    for (let i = 0; i < 3; i++) {
        rom[0x296 + i] = 0x00;
    }
    let exitOffset = version1_2 ? 0x276E : 0x276B;
    //disable exiting levels
    rom[exitOffset] = 0x18;
}